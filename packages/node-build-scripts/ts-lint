#!/usr/bin/env bash

# glob of source files to lint
FILES="{src,test}/**/*.{ts,tsx}"

if [[ -z $JUNIT_REPORT_PATH ]]; then
  # standard lint with friendly format
  tslint $FILES --format codeFrame $@
else
  # CI lint emits JUnit XML report file in <reports>/tslint/<pkg>.xml
  NAME=$(basename "$PWD")
  OUT="$CIRCLE_WORKING_DIRECTORY/$JUNIT_REPORT_PATH/tslint/$NAME.xml"
  tslint $FILES --format junit --out $OUT $@
  echo "JUnit report written to $OUT"
fi
